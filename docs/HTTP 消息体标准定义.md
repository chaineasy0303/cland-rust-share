# HTTP 消息体标准定义

# 消息体结构

HTTP 响应消息体采用 JSON 格式，包含以下字段：

- **code**: 整型，状态码，表示请求处理结果。
- **msg**: 字符串，描述请求处理状态或错误信息。
- **data**: JSON 对象，承载响应数据，可根据业务需求扩展。

### 字段定义

| 字段名 | 类型 | 描述 | 必填 |
| --- | --- | --- | --- |
| code | Integer | 状态码，指示处理结果 | 是 |
| msg | String | 状态描述或错误信息 | 是 |
| data | Object | 响应数据，结构依业务需求定义 | 否 |

## 状态码 (code) 设计

状态码为整型，采用 `{异常类别:3}{异常系统:4}{异常自定义:4}` 的结构，长度共 11 位，确保在整型范围内（-2,147,483,648 至 2,147,483,647）。

### 状态码规则

- **成功**:
    - `200`: 请求成功。
- **失败**:
    - `400` 或 `400XXXXYYYY`: 参数相关异常。
    - `500` 或 `500XXXXYYYY`: 系统相关异常。

### 状态码结构

| 部分 | 位数 | 描述 | 示例 |
| --- | --- | --- | --- |
| 异常类别 | 3 | HTTP 状态类别（如 200, 400, 500） | 400 |
| 异常系统 | 4 | 系统或模块标识，业务自定义 | 1001 |
| 异常自定义 | 4 | 具体错误标识，业务自定义 | 0001 |

### 示例状态码

- `40010010001`: 参数错误，系统 1001，错误 0001。
- `50020030002`: 系统错误，系统 2003，错误 0002。

### 状态码校验

- **范围校验**: 确保状态码在整型范围内。11 位结构（最大 99999999999）远小于整型上限，无溢出风险。
- **合法性校验**:
    - 异常类别仅允许 `200`, `400`, `500` 或其扩展。
    - 异常系统和自定义部分由业务定义，建议维护唯一性。

## 消息描述 (msg)

- **成功**: 简短描述，如 `"Success"`。
- **失败**: 详细错误信息，便于定位问题，如 `"Invalid parameter: user_id is missing"`。
- 建议长度控制在 255 字符内，避免过长。

## 数据对象 (data)

- **成功时**: 返回业务所需数据，结构由具体接口定义。
    
    ```json
    {
      "user_id": 123,
      "username": "example"
    }
    
    ```
    
- **失败时**: 可为空，或包含错误上下文。
    
    ```json
    {
      "error_field": "user_id",
      "error_detail": "must be a positive integer"
    }
    
    ```
    

## 示例

### 成功响应

```json
{
  "code": 200,
  "msg": "Success",
  "data": {
    "user_id": 123,
    "username": "example"
  }
}

```

### 参数错误

```json
{
  "code": 40010010001,
  "msg": "Invalid parameter: user_id is missing",
  "data": {
    "error_field": "user_id",

# 分页查询响应格式

分页查询接口的响应 `data` 字段采用如下结构：

- **total**: 整型，数据总条数。
- **page**: 整型，当前页码（从 1 开始）。
- **size**: 整型，每页条数。
- **pages**: 整型，总页数。
- **list**: 数组，当前页数据列表。

### 字段定义

| 字段名 | 类型 | 描述 | 必填 |
| --- | --- | --- | --- |
| total | Integer | 数据总条数 | 是 |
| page | Integer | 当前页码 | 是 |
| size | Integer | 每页条数 | 是 |
| pages | Integer | 总页数 | 是 |
| list | Array | 当前页数据列表 | 是 |

### 分页响应示例

```json
{
  "code": 200,
  "msg": "Success",
  "data": {
    "total": 100,
    "page": 1,
    "size": 10,
    "pages": 10,
    "list": [
      {
        "user_id": 123,
        "username": "example"
      },
      {
        "user_id": 124,
        "username": "test"
      }
    ]
  }
}
```

分页查询失败时，`list` 可为空数组，其他字段仍返回。
    "error_detail": "required field"
  }
}

```

### 系统错误

```json
{
  "code": 50020030002,
  "msg": "Database connection failed",
  "data": {}
}

```

## 注意事项

1. **状态码唯一性**: 确保 `{异常系统}{异常自定义}` 组合全局唯一，避免冲突。
2. **扩展性**: `data` 字段支持嵌套对象，适应复杂业务场景。
3. **国际化**: `msg` 可根据请求头 `Accept-Language` 返回多语言描述。
4. **校验**: 实现状态码生成和解析逻辑时，需验证整型范围和结构合法性。